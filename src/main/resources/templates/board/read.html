<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      layout:decorate="~{layout/basic.html}">

<div layout:fragment="content">
    <div class="container mt-3">
        <h3>[[${dto.bno}]]. <b>[[${dto.title}]]</b> 상세보기</h3>
        <p style="color: dimgray; text-align: right;">
            등록일 <b>[[${T(java.time.format.DateTimeFormatter).ofPattern('yyyy년 MM월 dd일').format(dto.createdAt)}]]</b>
        </p>
        <p style="color: dimgray; text-align: right;"> 조회수 [[${dto.hitCount}]]</p>
        <p style="color: dimgray; text-align: right;"> 상태 [[${dto.status}]]</p>
        <br/>

        <div class="form-group">
            <label for="writer">글쓴이:</label>
            <input type="text" class="form-control" id="writer" name="writer" th:value="${dto.writer}"
                   readonly="readonly">
        </div>
        <div class="form-group">
            <label for="content">내용:</label>
            <textarea name="content" id="content" class="form-control" readonly="readonly">[[${dto.content}]]</textarea>
        </div>
        <div class="form-group">
            <p for="replyCount">댓글 수: [[${dto.bno}]]</p>
        </div>
        <div class="form-group d-flex justify-content-end" style="margin-left: 5px;">
            <div sec:authorize="isAuthenticated()" th:if="${#authentication.principal.username==dto.getWriter()}" class="d-flex">
                <a th:href="|@{/board/modify(bno=${dto.bno})}|">
                    <button type="button" id="btnUpdate" class="btn btn-secondary mr-2">수정</button>
                </a>
                <form th:action="|@{/board/remove}|" method="post" onsubmit="return confirm('정말로 삭제하시겠습니까?')">
                    <input type="hidden" name="bno" th:value="${dto.bno}"/>
                    <button type="submit" class="btn btn-danger">삭제</button>
                </form>
            </div>
            <a th:href="|@{/board/list}|">
                <button type="button" id="btnList" class="btn btn-info">목록 보기</button>
            </a>
        </div>



    <h4>분실 정보</h4>
    <table class="table table-bordered table-hover mt-0 mb-30">
        <caption>분실신고자 정보</caption>
        <colgroup>
            <col style="width: 20%">
            <col style="width: 30%">
            <col style="width: 20%">
            <col style="width: 30%">
        </colgroup>
        <thead>
        <tr>
            <th scope="col">신고자</th>
            <th scope="col">연락처</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>[[${dto.user.nickname}]]</td>
            <td>[[${dto.user.mobile}]]</td>
        </tr>
        </tbody>
    </table>

    <h4>분실장소 및 날짜</h4>
    <table class="table table-bordered table-hover mt-0 mb-30">
        <caption>분실일시 및 장소 정보</caption>
        <colgroup>
            <col style="width: 20%">
            <col style="width: 80%">
        </colgroup>
        <thead>
        <tr>
            <th scope="col">분실날짜</th>
            <th scope="col">분실장소</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>[[${dto.lostDate}]]</td>
            <td>[[${dto.lostLocation}]]</td>
        </tr>
        </tbody>
    </table>

    <h4>분실동물 정보</h4>
    <table class="table table-bordered table-hover mt-0 mb-30">
        <caption>분실동물 정보</caption>
        <colgroup>
            <col style="width: 15%">
            <col style="width: 35%">
            <col style="width: 15%">
            <col style="width: 35%">
        </colgroup>
        <thead>
        <tr>
            <th scope="col">동물 이름</th>
            <th scope="col">품종</th>
            <th scope="col">성별</th>
            <th scope="col">털 색상</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>[[${dto.petName}]]</td>
            <td>[[${dto.petBreeds}]]</td>
            <td>[[${dto.petGender}]]</td>
            <td>[[${dto.petColor.color}]]</td>
        </tr>
        <tr>
            <th scope="row">나이</th>
            <td>[[${dto.petAge}]]</td>
            <th scope="row">몸무게</th>
            <td>[[${dto.petWeight}]]</td>
        </tr>
        <tr>
            <th scope="row">특징(구체적 묘사)</th>
            <td colspan="3">[[${dto.content}]]</td>
        </tr>
        </tbody>
    </table>

    <div id="map" style="width:500px;height:400px;"></div>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=41caa1d7d9b7baa2f49d25f886b4dc1f"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=APIKEY&libraries=LIBRARY"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=APIKEY&libraries=services"></script>

    <script>
        var container = document.getElementById('map');
        var options = {
            center: new kakao.maps.LatLng(33.450701, 126.570667),
            level: 3
        };

        var map = new kakao.maps.Map(container, options);
    </script>
    <script>
        var places = new kakao.maps.services.Places();

        var callback = function(result, status) {
            if (status === kakao.maps.services.Status.OK) {
                console.log(result);
            }
        };

        places.keywordSearch('dto.lostLocation', callback);
    </script>
    <!--    댓글 영역-->
    <div class="row mt-3">
        <div class="col-md-12">
            <div class="my-4 ">
                <button sec:authorize="isAuthenticated()" class="btn btn-info  addCommentBtn">ADD Comment</button>
            </div>
            <ul class="list-group commentList">
                댓글 리스트 영역
            </ul>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col">
            <ul class="pagination commentPaging">
            </ul>
        </div>
    </div>

    <div class="modal registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Register Replyer</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <span class="input-group-text">Reply Text</span>
                        <input type="text" class="form-control replyText">
                    </div>
                    <div class="input-group mb-3">
                        <span class="input-group-text">Replyer</span>
                        <input type="text" class="form-control replyer">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary registerBtn">Register</button>
                    <button type="button" class="btn btn-outline-dark closeRegisterBtn">Close</button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/js/reply.js"></script>

</div>
</div>
</html>